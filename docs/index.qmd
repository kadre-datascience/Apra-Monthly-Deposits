---
title: "APRA Monthly Banking Statistics"
title-block-banner: '#028577'
subtitle: Summary of Assets and Liabilities of Deposit Taking Financial Institutions in Australia
date: today 
date-format: DD MMMM YYYY
author: Christian Klettner
format: 
    html:
        css: www/kadre.css
        embed-resources: true
        include-after-body: www/footer.html
execute: 
    echo: false
---

```{ojs}
import {Plot} from "@mkfreeman/plot-tooltip";
import {addTooltips} from "@mkfreeman/plot-tooltip";
```


```{ojs}
data = FileAttachment("banking_stats.json").json()
measures = data.map(d => d.Measure).filter(function (e, i, x) {return x.indexOf(e, i+1) === -1;}); 
sectors = data.map(d => d.Sector).filter(function (e, i, x) {return x.indexOf(e, i+1) === -1;}); 
```


```{ojs}
viewof measure = Inputs.select(measures, 
  {value: "Total residents assets", label: "Financial Measures", width: 300, multiple: false})
```

```{ojs}
viewof sector = Inputs.select(sectors, 
  {value: "BIG 4", label: "Banking Sectors", width: 300, multiple: true})
```

&nbsp;  

```{ojs}
data_filter = data.filter(x => x.Measure==measure).filter(x => sector.includes(x.Sector)); 
addTooltips(
  Plot.plot({
    height: 800,
    color: { legend: true },
    y: { grid: false, type: "log", label: "Value: $million"},
    x: { type: "utc" }, 
    marks: [
      Plot.axisX({anchor: "top", label: "Frequency (%) â†’"}),
      Plot.ruleY([0]),
      Plot.line(data_filter, 
        { x: "Period", y: "ValueMillion", stroke: "Sector", 
          z: "InstitutionSumm", title: "InstitutionSumm", opacity: 0.5 })
      ]
  }), 
  { stroke: "black" }
)
```
